
<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<pre class="r"><code>library(tidyverse)</code></pre>
<pre><code>## ── Attaching packages ─────────────────────────────────────── tidyverse 1.3.0 ──</code></pre>
<pre><code>## ✓ ggplot2 3.3.3     ✓ purrr   0.3.4
## ✓ tibble  3.0.6     ✓ dplyr   1.0.4
## ✓ tidyr   1.1.2     ✓ stringr 1.4.0
## ✓ readr   1.4.0     ✓ forcats 0.5.1</code></pre>
<pre><code>## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
## x dplyr::filter() masks stats::filter()
## x dplyr::lag()    masks stats::lag()</code></pre>
<pre class="r"><code>realfootball&lt;- read_csv(&quot;EPLredcard_data.csv&quot;)</code></pre>
<pre><code>## 
## ── Column specification ────────────────────────────────────────────────────────
## cols(
##   Date = col_character(),
##   Player = col_character(),
##   Team = col_character(),
##   Match = col_character(),
##   `Time of Red Cards Given` = col_character(),
##   `Final Results` = col_character(),
##   WLT = col_character()
## )</code></pre>
<pre class="r"><code>realfootball %&gt;% 
  group_by(`Time of Red Cards Given`, WLT) %&gt;%
  summarise(
    total = n())%&gt;% 
  arrange(`Time of Red Cards Given`)</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Time of Red Cards Given&#39;. You can override using the `.groups` argument.</code></pre>
<pre><code>## # A tibble: 66 x 3
## # Groups:   Time of Red Cards Given [55]
##    `Time of Red Cards Given` WLT   total
##    &lt;chr&gt;                     &lt;chr&gt; &lt;int&gt;
##  1 11&#39;                       L         1
##  2 11&#39;                       W         1
##  3 12&#39;                       L         2
##  4 14&#39;                       L         1
##  5 15&#39;                       L         1
##  6 19&#39;                       W         1
##  7 20&#39;                       L         1
##  8 24&#39;                       T         1
##  9 25&#39;                       T         1
## 10 26&#39;                       T         1
## # … with 56 more rows</code></pre>
<pre class="r"><code>RCD &lt;- realfootball %&gt;%
  group_by(`Time of Red Cards Given`, WLT)%&gt;%
  summarise(
    total = n())</code></pre>
<pre><code>## `summarise()` has grouped output by &#39;Time of Red Cards Given&#39;. You can override using the `.groups` argument.</code></pre>
<pre class="r"><code>RCD</code></pre>
<pre><code>## # A tibble: 66 x 3
## # Groups:   Time of Red Cards Given [55]
##    `Time of Red Cards Given` WLT   total
##    &lt;chr&gt;                     &lt;chr&gt; &lt;int&gt;
##  1 11&#39;                       L         1
##  2 11&#39;                       W         1
##  3 12&#39;                       L         2
##  4 14&#39;                       L         1
##  5 15&#39;                       L         1
##  6 19&#39;                       W         1
##  7 20&#39;                       L         1
##  8 24&#39;                       T         1
##  9 25&#39;                       T         1
## 10 26&#39;                       T         1
## # … with 56 more rows</code></pre>
<pre class="r"><code>RCD %&gt;% 
  separate(`Time of Red Cards Given`, into=c(&quot;RegularTime&quot;, &quot;AddedTime&quot;), sep=&quot;\\+&quot;) %&gt;% 
  mutate_all(funs(ifelse(is.na(.), 0, .))) %&gt;% 
  mutate(
    `RegularTime` = as.numeric(gsub(&quot;&#39;&quot;, &quot;&quot;, `RegularTime`, fixed=TRUE)),
    `AddedTime`   = as.numeric(gsub(&quot;&#39;&quot;, &quot;&quot;, `AddedTime`, fixed=TRUE)),
    total_time = `RegularTime` + `AddedTime`
    ) %&gt;% 
  mutate(
    game_section = case_when(
      RegularTime &lt;= 15  ~ &quot;1-15&quot;,
      RegularTime &gt;= 16 &amp; RegularTime &lt;= 30 ~ &quot;16-30&quot;,
      RegularTime &gt;= 31 &amp; RegularTime &lt;= 45~ &quot;31-45&quot;,
      RegularTime &gt;= 46 &amp; RegularTime &lt;= 60~ &quot;46-60&quot;,
      RegularTime &gt;= 61 &amp; RegularTime &lt;= 75 ~ &quot;61-75&quot;,
      RegularTime &gt;= 76 &amp; RegularTime &lt;= 90 ~ &quot;76-90&quot;,
      TRUE ~ as.character(total_time)
      ) 
  ) -&gt; footballredcards</code></pre>
<pre><code>## Warning: Expected 2 pieces. Missing pieces filled with `NA` in 58 rows [1, 2, 3,
## 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15, 16, 17, 18, 19, 20, ...].</code></pre>
<pre><code>## Warning: `funs()` is deprecated as of dplyr 0.8.0.
## Please use a list of either functions or lambdas: 
## 
##   # Simple named list: 
##   list(mean = mean, median = median)
## 
##   # Auto named with `tibble::lst()`: 
##   tibble::lst(mean, median)
## 
##   # Using lambdas
##   list(~ mean(., trim = .2), ~ median(., na.rm = TRUE))
## This warning is displayed once every 8 hours.
## Call `lifecycle::last_warnings()` to see where this warning was generated.</code></pre>
<pre class="r"><code>ggplot(footballredcards, aes(x=game_section, weight=total, fill=WLT)) + 
  geom_bar() +
  labs(
    title=&quot;Results based on Timing of Red Cards in the Premier League&quot;, 
    x=&quot;Minute of Red Card Given&quot;, 
    y=&quot;Amount of Red Cards Given&quot;) +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.title = element_text(size = 12), 
    plot.subtitle = element_text(size=12), 
    panel.grid.minor = element_blank()
    )</code></pre>
<p><img src="/post/2021-04-03-how-impactful-are-red-cards/Reina_realfootball_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<pre class="r"><code>ggplot() + geom_bar(data=footballredcards, aes(x=game_section, weight=total, fill=WLT)) + theme_minimal() + coord_polar()+
  labs(
    title=&quot;Results based on Timing of Red Cards in the Premier League&quot;, 
    x=&quot;Minute of Red Card Given&quot;, 
    y=&quot;Amount of Red Cards Given&quot;) +
  theme_minimal()+
  theme(
    plot.title = element_text(size = 16, face = &quot;bold&quot;),
    axis.title = element_text(size = 12), 
    plot.subtitle = element_text(size=12), 
    panel.grid.minor = element_blank()
    )</code></pre>
<p><img src="/post/2021-04-03-how-impactful-are-red-cards/Reina_realfootball_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
